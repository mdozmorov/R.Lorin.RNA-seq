RepeatSoaker effect on DEGs detection
========================================================



```{r setup, echo=FALSE, include=FALSE, cache=FALSE}
# Set up the environment
library(knitr) 
opts_chunk$set(cache.path='cache/', fig.path='img/', cache=F, tidy=T, fig.keep='high', echo=T, dpi=300, out.width=700)
options(replace.assign=TRUE, width=120)
set.seed(1)
HIDE=F # If true, mask any data labels
```



```{r loadLibraries, echo=FALSE, warning=FALSE, message=FALSE}
library("cummeRbund")
```

```{r loadData}
cuff_data <- lapply(list(all="data//cuffdiff-/", r75="data//cuffdiff-.75/", r50="data//cuffdiff-.50/", r25="data//cuffdiff-.25", r01="data//cuffdiff-.01/", r00="data//cuffdiff-.00"), readCufflinks)
```

```{r diffGeneIDs}
DEGcount <- function(cuff_data) {
  # As in the manual
  gene_diff_data <- diffData(genes(cuff_data),"CTRL","MUT",features=T)
  sig_gene_data <- subset(gene_diff_data, (significant == 'yes')) # Get significant only
  return(nrow(sig_gene_data))
}

sapply(cuff_data, DEGcount)



sig_gene_data <- subset(gene_diff_data, (p_value < 0.05))
nrow(sig_gene_data)
sig_gene_data<-subset(sig_gene_data,abs(log2_fold_change)>log2(1.5)) # With 2-fold cutoff
nrow(sig_gene_data)
sig_gene_data<-sig_gene_data[sig_gene_data$value_1>3|sig_gene_data$value_2>3,] # and expression >3 in at least one condition
nrow(sig_gene_data)
# sig_gene_names<- featureNames(sig_gene_data)
write.table(merge(sig_gene_data,featureNames(getGenes(cuff_data,sig_gene_data$gene_id)),by.x="gene_id",by.y="tracking_id"),"F:/222.txt",sep="\t",row.names=F)



```

